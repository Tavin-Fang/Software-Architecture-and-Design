{% extends "base.html" %}
{% import "bootstrap/wtf.html" as wtf %}

{% block page_content %}
<div class="row">
    <div class="col-lg-6">
       {% if current_user.can_add_device %}
        <a class="btn btn-info" href="{{ url_for('add_device') }}">添加新设备</a>
        {% endif %}
    </div>
    <form class="form-inline" method="post" role="form">
        {{ form.hidden_tag() }}
        {{ wtf.form_errors(form, hiddens="True") }}
        <div class="col-lg-6">
            <div class="input-group">
                {{ form.name(class="form-control", placeholder="输入设备名进行查询") }}
                <span class="input-group-btn">
                    {{ wtf.form_field(form.submit) }}
                </span>
            </div>
        </div>
    </form>
</div>

<!--设备列表-->
{% if devices %}
<table class="table table-striped table-condensed">
    <thead>
        <tr>
            <th>设备编号</th>
            <th>实验室名</th>
            <th>设备名</th>
            <th>购置时间</th>
            <th>购置人</th>
            {% if current_user.can_del %}
            <th>操作</th>
            {% endif %}
        </tr>
    </thead>
    <tbody>
        {% for dev in devices %}
            <tr>
                <td>{{ dev.device_id }}</td>
                <td>{{ dev.lab }}</td>
                <td>
                    <a href="{{ url_for('device_details', id=dev.id) }}">{{ dev.name }}</a>
                </td>
                <td>{{ dev.time.strftime('%Y-%m-%d %H:%M:%S') }}</td>
                <td>{{ dev.user.username }}</td>
                {% if current_user.can_del %}
                <td>
                    <a class="btn btn-danger btn-sm"
                       href="{{ url_for('remove_device', id=dev.id) }}"
                       onclick="return confirm('确定要删除吗？');">删除</a>
                </td>
                {% endif %}
            </tr>
        {% endfor %}
    </tbody>
</table>
{% else %}
<p>看来没有符合条件的设备</p>
{% endif %}
{% endblock %}
